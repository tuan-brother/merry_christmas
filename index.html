<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÑ Merry Christmas ‚ù§Ô∏è</title>
<style>
html,body{
  margin:0;
  background:#000;
  overflow:hidden;
  font-family:Arial;
}
#gift{
  position:fixed;
  bottom:40px;
  left:50%;
  transform:translateX(-50%);
  font-size:60px;
  cursor:pointer;
  transition:.3s;
}
#gift:hover{ transform:translateX(-50%) scale(1.2); }

#result{
  position:fixed;
  top:20%;
  width:100%;
  text-align:center;
  font-size:32px;
  color:#ff4d6d;
  display:none;
}
</style>
</head>
<body>

<div id="result"></div>
<div id="gift">üéÅ</div>

<!-- THREE JS CDN (UMD, kh√¥ng module) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>

<script>
/* ================= SCENE ================= */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
camera.position.z = 70;

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* ================= HEART PARTICLES ================= */
const particles = 2000;
const geo = new THREE.BufferGeometry();
const pos = [];

for(let i=0;i<particles;i++){
  const t = Math.random()*Math.PI*2;
  const x = 16*Math.pow(Math.sin(t),3);
  const y = 13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
  pos.push(
    x*1.5 + (Math.random()-0.5)*2,
    y*1.5 + (Math.random()-0.5)*2,
    (Math.random()-0.5)*20
  );
}

geo.setAttribute('position', new THREE.Float32BufferAttribute(pos,3));

const mat = new THREE.PointsMaterial({
  color:0xff3366,
  size:0.6,
  transparent:true
});

const heart = new THREE.Points(geo,mat);
scene.add(heart);

/* ================= FIREWORK TEXT ================= */
function fireText(){
  const div = document.createElement("div");
  div.innerHTML="‚ù§Ô∏è MERRY CHRISTMAS ‚ù§Ô∏è";
  div.style.position="fixed";
  div.style.top="40%";
  div.style.width="100%";
  div.style.textAlign="center";
  div.style.fontSize="36px";
  div.style.color="#ff6b81";
  div.style.animation="boom 1.2s ease";
  document.body.appendChild(div);
  setTimeout(()=>div.remove(),1200);
}

/* ================= CLICK HEART ================= */
renderer.domElement.addEventListener("click",()=>{
  fireText();
});

/* ================= GIFT CLICK 1 L·∫¶N ================= */
document.getElementById("gift").onclick=()=>{
  const KEY = "christmas_gift_2025_huyen_dang";
  const r=document.getElementById("result");

  // ƒê√£ nh·∫≠n qu√†
  if(localStorage.getItem(KEY)){
    r.innerHTML="üéÑ B·∫°n ƒë√£ nh·∫≠n qu√† r·ªìi! H·∫πn g·∫∑p l·∫°i Gi√°ng Sinh nƒÉm sau ‚ù§Ô∏è";
    r.style.display="block";
    setTimeout(()=>r.style.display="none",3000);
    return;
  }

  // Ch∆∞a nh·∫≠n
  const money=[50000,100000,150000,200000,300000];
  const pick=money[Math.floor(Math.random()*money.length)];

  localStorage.setItem(KEY,pick);

  r.innerHTML=`üéâ Ch√∫c m·ª´ng! B·∫°n nh·∫≠n ƒë∆∞·ª£c ${pick.toLocaleString()} VNƒê üéâ`;
  r.style.display="block";

  // ·∫®n qu√† sau khi nh·∫≠n
  document.getElementById("gift").style.display="none";
};

/* ================= ANIMATE ================= */
function animate(){
  requestAnimationFrame(animate);
  heart.rotation.y += 0.002;
  heart.rotation.x += 0.001;
  renderer.render(scene,camera);
}
animate();

/* ================= RESIZE ================= */
window.onresize=()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
}
</script>
</body>
</html>
